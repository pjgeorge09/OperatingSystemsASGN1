This code is currently running, after suggestions from other students.
I spent much of my time on the other code, but it always segfaulted.
